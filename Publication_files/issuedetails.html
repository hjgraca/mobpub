<html>

    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
        <meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
        <title>iServer Publisher: Issue Details</title>

        <link rel="stylesheet" type="text/css" href="publication.css">

        <SCRIPT LANGUAGE="JavaScript">

            function getIssueDetails()
            {
                var parentWindow = window.opener;
                if (parentWindow)
                {
                    if (!parentWindow.closed)
                    {
                        var Issue = parentWindow.iServerData.CurrentIssue;
                        if (!Issue)
                        {
                            alert("An error occurred when loading this Issue. Please try again");
                            window.close();

                        } else {

                            IssueDetailsForm.IssueName.value = Issue.Name;
                            IssueDetailsForm.IssueDescription.value = Issue.Description;
                            IssueDetailsForm.IssueCategory.value = Issue.Category;
                            IssueDetailsForm.IssueActionType.value = Issue.ActionType;
                            IssueDetailsForm.IssuePriority.value = Issue.Priority;
                            IssueDetailsForm.IssueStatus.value = Issue.Status;
                            IssueDetailsForm.IssueIsClosed.value = Issue.Closed;
                            IssueDetailsForm.IssueCreatedOn.value = Issue.Timestamp.CreatedOn;
                            IssueDetailsForm.IssueCreatedBy.value = Issue.Timestamp.CreatedBy;
                            IssueDetailsForm.IssueLastModifiedOn.value = Issue.Timestamp.LastModifiedOn;
                            IssueDetailsForm.IssueLastModifiedBy.value = Issue.Timestamp.LastModifiedBy;

                            if (Issue.InformationUsers.length == 0)
                            {
                                IssueDetailsForm.IssueInformationUsers.options[0].text = "No Information Users";
                            } else {
                                for (var count = 0; count < Issue.InformationUsers.length; count++)
                                {
                                    comboOpt = document.createElement("OPTION");
                                    comboOpt.value = Issue.InformationUsers[count].Name;
                                    comboOpt.text = Issue.InformationUsers[count].Name;
                                    IssueDetailsForm.IssueInformationUsers.add(comboOpt, IssueDetailsForm.IssueInformationUsers.options.length);
                                }
                            }

                            if (Issue.ActionUsers.length == 0)
                            {
                                IssueDetailsForm.IssueActionUsers.options[0].text = "No Action Users";
                            } else {
                                for (var count = 0; count < Issue.ActionUsers.length; count++)
                                {
                                    comboOpt = document.createElement("OPTION");
                                    comboOpt.value = Issue.ActionUsers[count].Name;
                                    comboOpt.text = Issue.ActionUsers[count].Name;
                                    IssueDetailsForm.IssueActionUsers.add(comboOpt, IssueDetailsForm.IssueActionUsers.options.length);
                                }
                            }
                        }

                    } else {

                        alert("The parent diagram window has been closed so the issue can not be displayed");
                        window.close();
                    }
                }else
                {
                    alert("This file cannot be loaded on its own. Press OK to close.");
                    window.close();
                }
            }

        </SCRIPT>

    </head>

<body topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0" onload="getIssueDetails()">

<div align="center" >
	<form name="IssueDetailsForm" onSubmit="return sendAsEmail(this)">
	<table border="0" cellpadding="0" width="496" bordercolor="#000000" id="table1" background="Images/postit_tall.jpg">
		<tr>
			<td>
			<div align="center">
				<table border="0" cellpadding="0" style="border-collapse: collapse" width="496" bordercolor="#000000" id="table2">
					<tr>
						<td width="25" height="22" class="tdCommentFormText">&nbsp;</td>
						<td width="440" height="22" colspan="4" class="tdCommentFormText">&nbsp;</td>
						<td width="36" height="22" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="45" class="tdCommentFormText">&nbsp;</td>
						<td width="440" height="45" colspan="4" class="tdCommentFormText">
						&nbsp;</td>
						<td width="36" height="45" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="26" class="tdCommentFormText">&nbsp;</td>
						<td width="440" colspan="4" height="26" class="tdCommentFormText" style="vertical-align: middle"><b>
						View Issue Details</b></td>
						<td width="36" height="26" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="19" class="tdCommentFormText"></td>
						<td width="14" height="19" class="tdCommentFormText"></td>
						<td width="141" height="19" class="tdCommentFormText">
						</td>
						<td width="285" height="19" colspan="2" class="tdCommentFormText">
						</td>
						<td width="36" height="19" class="tdCommentFormText"></td>
					</tr>
					<tr>
						<td width="25" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="33" class="tdCommentFormText">
						Issue Name</td>
						<td width="285" height="33" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueName" size="37" maxlength="200" readonly></td>
						<td width="36" height="33" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="33" class="tdCommentFormText">
						Description</td>
						<td width="285" height="33" colspan="2" class="tdCommentFormText">
						<textarea rows="3" name="IssueDescription" cols="28"  readonly ></textarea></td>
						<td width="36" height="33" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Category</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueCategory" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Action Type</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueActionType" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Priority</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssuePriority" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Status</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueStatus" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Is Closed</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueIsClosed" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Action Users</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<select size="1" name="IssueActionUsers" readonly>
						<option>Click to View Action Users</option>
						</select></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Information Users</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<select size="1" name="IssueInformationUsers" readonly>
						<option>Click to View Information Users</option>
						</select></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="40" class="tdCommentFormText">&nbsp;</td>
						<td width="440" colspan="4" height="40" class="tdCommentFormText"><b>
						Issue Timestamp</b></td>
						<td width="36" height="40" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Created On</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueCreatedOn" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Created By</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueCreatedBy" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Last Modified On</td>
						<td width="285" height="30" colspan="2" class="tdCommentFormText">
						<input type="text" name="IssueLastModifiedOn" size="37" maxlength="200" readonly></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="30" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="30" class="tdCommentFormText">
						Last Modified By</td>
						<td width="193" height="30" class="tdCommentFormText">
						<p align="left">
						<input type="text" name="IssueLastModifiedBy" size="23" maxlength="200" readonly></td>
						<td width="92" height="30" class="tdCommentFormText">
						<p align="left">
						<input type="button" value="Close" name="Close" onclick="window.close()"></td>
						<td width="36" height="30" class="tdCommentFormText">&nbsp;</td>
					</tr>
					<tr>
						<td width="25" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="14" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="141" height="33" class="tdCommentFormText">&nbsp;</td>
						<td width="285" height="33" colspan="2" class="tdCommentFormText">
						&nbsp;</td>
						<td width="36" height="33" class="tdCommentFormText">&nbsp;</td>
					</tr>
					</table>
			</div>
			</td>
		</tr>
	</table>
	</form>
</div>

</body>

</html>